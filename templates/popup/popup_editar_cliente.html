{% if not cliente %}
    <div class="alert alert-warning">
        Nenhum cliente encontrado. Por favor, crie um novo cliente ou selecione um existente.
    </div>
{% else %}
    <!-- Create Contract Modal -->
    <div class="modal fade" id="updateClientModal" tabindex="-1" aria-labelledby="updateClientModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header bg-warning text-white">
                    <h5 class="modal-title" id="updateClientModalLabel">Editar Cliente</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="contractForm" action="{{ url_for('cliente_bp.update_cliente') }}" method="POST">
                        <!-- Basic Information Section -->
                        <div class="card mb-2">
                        <div class="card-header section-header d-flex justify-content-between align-items-center" data-bs-toggle="collapse" href="#addressCollapse" role="button">
                        <h5 class="mb-0">Informações Básicas</h5>
                        </div>
                        <div class="collapse show" id="basicInfoCollapse">
                            <div class="card-body">
                                <div class="row g-3">
                                    <div class="col-md-2">
                                        <label class="form-label">Nº Contrato</label>
                                        <input type="text" class="form-control" id="numero_contrato" name="numero_contrato" value="{{ cliente.numero_contrato }}" onchange="buscarDadosContrato(this.value)">
                                        <div id="loadingContrato" class="input-group-text d-none">
                                            <div class="spinner-border spinner-border-sm" role="status"></div>
                                        </div>
                                    </div>
                                    <div class="col-md-2">
                                        <label class="form-label">Sequência</label>
                                        <input type="text" class="form-control" value="{{ cliente.sequencia }}" id="sequencia"  name="sequencia">
                                    </div>
                                    <div class="col-md-4">
                                        <label class="form-label">Cadastramento</label>
                                        <input type="text" class="form-control" value="{{ cliente.cadastramento }}" id="cadastramento" name="cadastramento" >
                                    </div>
                                    <div class="col-md-4">
                                        <label class="form-label">Atualização</label>
                                        <input type="text" class="form-control" value="{{ cliente.atualizacao }}" id="atualizacao" name="atualizacao" >
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Razão Social</label>
                                        <input type="text" class="form-control" value="{{ cliente.razao_social }}" id="razao_social" name="razao_social">
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Nome Fantasia</label>
                                        <input type="text" class="form-control" value="{{ cliente.nome_fantasia }}" id="nome_fantasia" name="nome_fantasia" >
                                    </div>
                                    <div class="col-md-3">
                                        <label class="form-label">Tipo</label>
                                        <input type="text" class="form-control" value="{{ cliente.tipo }}" id="tipo" name="tipo" >
                                    </div>
                                    <div class="col-md-3">
                                        <label class="form-label">CNPJ</label>
                                        <input type="text" class="form-control" value="{{ cliente.cnpj }}" id="cnpj" name="cnpj">
                                    </div>
                                    <div class="col-md-3">
                                        <label class="form-label">IE</label>
                                        <input type="text" class="form-control" value="{{ cliente.ie }}" id="ie" name="ie">
                                    </div>
                                    <div class="col-md-3">
                                        <label class="form-label">IM</label>
                                        <input type="text" class="form-control" value="{{ cliente.im }}" id="im" name="im" >
                                    </div>
                                    <div class="col-md-4">
                                        <label class="form-label">E-mail</label>
                                        <input type="text" class="form-control" value="{{ cliente.email }}" id="email" name="email" >
                                    </div>
                                    <div class="col-md-4">
                                        <label class="form-label">Fone</label>
                                        <input type="text" class="form-control" value="{{ cliente.telefone }}" id="telefone" name="telefone">
                                    </div>
                                    <div class="col-md-12">&nbsp;</div> <!-- Coluna extra para manter o layout correto -->
                                </div>
                            </div>
                        </div>

                        <!-- Customer Address Section -->
                        <div class="card mb-2">
                            <div class="card-header section-header d-flex justify-content-between align-items-center" data-bs-toggle="collapse" href="#addressCollapse" role="button">
                                <h5 class="mb-0">Endereço do Cliente</h5>
                            </div>
                            <div class="collapse show" id="addressCollapse">
                                <div class="card-body">
                                    <div class="row g-3">
                                        <div class="col-md-2">
                                            <label class="form-label">CEP</label>
                                            <input type="text" class="form-control" value="{{ cliente.cep }}" id="cep" name="cep">
                                        </div>
                                        <div class="col-md-6">
                                            <label class="form-label">Endereço</label>
                                            <input type="text" class="form-control" value="{{ cliente.endereco }}" id="endereco" name="endereco">
                                        </div>
                                        <div class="col-md-2">
                                            <label class="form-label">Compl.</label>
                                            <input type="text" class="form-control" value="{{ cliente.complemento }}" id="complemento" name="complemento">
                                        </div>
                                        <div class="col-md-2">
                                            <label class="form-label">Bairro</label>
                                            <input type="text" class="form-control" value="{{ cliente.bairro }}" id="bairro" name="bairro">
                                        </div>
                                        <div class="col-md-4">
                                            <label class="form-label">Cidade</label>
                                            <input type="text" class="form-control" value="{{ cliente.cidade }}" id="cidade" name="cidade">
                                        </div>
                                        <div class="col-md-1">
                                            <label class="form-label">UF</label>
                                            <select class="form-select" value="{{ cliente.estado }}" id="estado" name="estado">
                                                <option value="RJ">RJ</option>
                                                <option value="SP">SP</option>
                                                <option value="MG">MG</option>
                                                <option value="DF">DF</option>
                                                <option value="SC">SC</option>
                                                <option value="ES">ES</option>
                                                <option value="AC">AC</option>
                                                <option value="CE">CE</option>
                                                <option value="AL">AL</option>
                                                <option value="BA">BA</option>
                                                <option value="AM">AM</option>
                                                <option value="SE">SE</option>
                                                <option value="TO">TO</option>
                                                <option value="RR">RR</option>
                                                <option value="PI">PI</option>
                                                <option value="RN">RN</option>
                                                <option value="RS">RS</option>
                                                <option value="PB">PB</option>
                                                <option value="PR">PR</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Contract Conditions Section -->
                        <div class="card mb-2">
                            <div class="card-header section-header d-flex justify-content-between align-items-center" data-bs-toggle="collapse" href="#contractCollapse" role="button">
                                <h5 class="mb-0">Condições do Contrato do Cliente</h5>
                            </div>
                            <div class="collapse show" id="contractCollapse">
                                <div class="card-body">
                                    <div class="row g-3">
                                        <div class="col-md-3">
                                            <label class="form-label">Fator moderador da taxa de juros</label>
                                            <div class="input-group">
                                                <input type="number" class="form-control" value="{{ cliente.fator_juros }}" id="fator_juros" name="fator_juros" step="0.01">
                                                <span class="input-group-text">%</span>
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <label class="form-label">Estado</label>
                                            <input type="text" class="form-control status-ativo" value="{{ cliente.estado_atual }}" id="estado_atual" name="estado_atual" >
                                        </div>
                                        <div class="col-md-3">
                                            <label class="form-label">Tipo Cobrança</label>
                                            <input type="text" class="form-control status-ativo" value="{{ cliente.cobranca_tipo }}" id="cobranca_tipo" name="cobranca_tipo" >
                                        </div>
                                        <div class="col-md-3">
                                            <label class="form-label">Data</label>
                                            <input type="text" class="form-control" value="{{ cliente.data_estado }}" id="data_estado" name="data_estado" >
                                        </div>
                                        <div class="col-md-3">
                                            <label class="form-label">Plano</label>
                                            <input type="text" class="form-control" value="{{ cliente.plano_nome }}" id="plano_nome" name="plano_nome">
                                        </div>
                                        <div class="col-md-3">
                                            <label class="form-label">Dia Vencimento</label>
                                            <input type="text" class="form-control" value="{{ cliente.dia_vencimento }}" id="dia_vencimento" name="dia_vencimento">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Other Details Section -->
                        <div class="card">
                            <div class="card-header section-header d-flex justify-content-between align-items-center" data-bs-toggle="collapse" href="#otherDetailsCollapse" role="button">
                                <h5 class="mb-0">Outros Detalhes do Cliente</h5>
                            </div>
                            <div class="collapse show" id="otherDetailsCollapse">
                                <div class="card-body">
                                    <div class="row g-3">
                                        <div class="col-md-6">
                                            <label class="form-label">Observações</label>
                                            <textarea class="form-control" rows="3" name="observacao">{{ cliente.observacao }}</textarea>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Modal Footer -->
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                            <button type="submit" class="btn btn-primary">Salvar Alterações</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
{% endif %}
